/*! pres-timer - v1.0.0 Build date: 2014-07-26 */function Timer(){self=this,this.interval=1e3,this.paused=!1,this.defaultTime=60,this.remainingTime=this.defaultTime,this.timeArray={},this.timerWindow=window,this.controlWindow=window,this.build=function(a,b){b||(b=""),a||(a="display.html");var c=window.open(a,b,"_blank","menubar=no, location=no, status=no, titlebar=no, toolbar=no");this.timerWindow=c,this.controlWindow.addEventListener("start",function(){self.start()}),this.controlWindow.addEventListener("pause",function(){self.pause()}),this.controlWindow.addEventListener("stop",function(){self.stop()}),this.controlWindow.addEventListener("setTime",function(a){var b=3600*parseInt(a.detail.hours)+60*parseInt(a.detail.minutes)+parseInt(a.detail.seconds);self.setTime(b),self.timeArray=self.convertTime(self.remainingTime),self.removeColors(),self.tickEvent()}),this.controlWindow.addEventListener("setInterval",function(a){var b=a.detail;self.setInterval(b)}),this.timerWindow.addEventListener("getTime",function(){self.tickEvent()}),this.controlWindow.addEventListener("sendMessage",function(a){self.writeMessage(a.detail)})},this.tickEvent=function(){var a=new CustomEvent("tick",{detail:this.timeArray});this.controlWindow.dispatchEvent(a),this.timerWindow.dispatchEvent(a)},this.tick=function(){return this.paused!==!0&&this.remainingTime>0?(this.remainingTime<=120&&this.twoMins(),this.remainingTime-=1,this.timeArray=this.convertTime(this.remainingTime),this.tickEvent(),this.controlWindow.setTimeout("self.tick()",this.interval),this.remainingTime<=0&&this.timeUp(),void 0):!1},this.setInterval=function(a){return a?(this.interval=a,!0):!1},this.setTime=function(a){return a?(this.remainingTime=a,!0):!1},this.convertTime=function(a){var b=a%60,c=Math.floor(a%3600/60),d=Math.floor(a/3600),e={hours:d,minutes:c,seconds:b};return e},this.decodeTime=function(a){var b=3600*a.hours+60*a.minutes+a.seconds;return b},this.start=function(){this.paused=!1;var a=new Event("start");return self.timerWindow.dispatchEvent(a),this.tick(),!0},this.pause=function(){this.paused=!0;var a=new Event("pause");return self.timerWindow.dispatchEvent(a),!0},this.stop=function(){this.pause(),this.setInterval(1e3),this.setTime(this.defaultTime);var a=new Event("stop");self.timerWindow.dispatchEvent(a)},this.timeUp=function(){var a=new Event("timeUp");self.timerWindow.dispatchEvent(a),self.controlWindow.dispatchEvent(a)},this.twoMins=function(){var a=new Event("twoMins");self.timerWindow.dispatchEvent(a),self.controlWindow.dispatchEvent(a)},this.writeMessage=function(a){var b=new CustomEvent("displayMessage",{detail:a});this.timerWindow.dispatchEvent(b)},this.removeColors=function(){var a=new Event("rmColors");self.timerWindow.dispatchEvent(a),self.controlWindow.dispatchEvent(a)}}function Control(){that=this,this.timerWindow=window,this.build=function(){var a=document.querySelector("#start"),b=document.querySelector("#pause"),c=document.querySelector("#stop"),d=document.querySelector('input[name="interval"]'),e=document.querySelector("#setTime"),f=document.querySelector("button#sendMessage"),g=document.querySelector("button#clearMessage");window.addEventListener("tick",function(a){var b=a.detail;that.writeTime(b)}),d.addEventListener("change",function(){var a=new CustomEvent("setInterval",{detail:that.readInterval()});window.dispatchEvent(a)}),e.addEventListener("click",function(){var a=new CustomEvent("setTime",{detail:that.readTime()});window.dispatchEvent(a)}),a.addEventListener("click",function(){var a=new Event("start");window.dispatchEvent(a)}),b.addEventListener("click",function(){var a=new Event("pause");window.dispatchEvent(a)}),c.addEventListener("click",function(){var a=new Event("stop");window.dispatchEvent(a);var b=new CustomEvent("setTime",{detail:that.readTime()});window.dispatchEvent(b)}),f.addEventListener("click",function(){that.sendMessage()}),g.addEventListener("click",function(){that.clearMessage()});var h=new CustomEvent("setTime",{detail:this.readTime()});window.dispatchEvent(h)},this.formatTime=function(a){for(var b in a)a[b]=parseInt(a[b]);for(var c in a)(a[c]<10||a[c].length<2)&&(a[c]="0"+a[c]);return a},this.writeTime=function(a){var b=document.querySelector("#counter_control");a=this.formatTime(a),b.innerHTML=a.hours+":"+a.minutes+":"+a.seconds},this.readTime=function(){var a=document.querySelector('input[name="hours"]').value,b=document.querySelector('input[name="minutes"]').value,c=document.querySelector('input[name="seconds"]').value;(""===a||null===a||void 0===a)&&(a=0),(""===b||null===b||void 0===b)&&(b=0),(""===c||null===c||void 0===c)&&(c=0);var d={hours:a,minutes:b,seconds:c};return d},this.readInterval=function(){var a=document.querySelector('input[name="interval"]').value;return a},this.sendMessage=function(){var a=document.querySelector('input[name="message"]');a.disabled=!0;var b=new CustomEvent("sendMessage",{detail:a.value});that.timerWindow.dispatchEvent(b)},this.clearMessage=function(){var a=document.querySelector('input[name="message"]');a.value="",a.disabled=!1;var b=new CustomEvent("sendMessage",{detail:""});that.timerWindow.dispatchEvent(b)}}var removeColors=function(){var a=document.querySelector("#counter_control");a.classList.remove("paused"),a.classList.remove("timeup"),a.classList.remove("twoMins")};window.addEventListener("rmColors",function(){removeColors()}),window.addEventListener("pause",function(){var a=document.querySelector("#counter_control");removeColors(),a.classList.add("paused")}),window.addEventListener("start",function(){document.querySelector("#counter_control");removeColors()}),window.addEventListener("stop",function(){document.querySelector("#counter_control");removeColors()}),window.addEventListener("timeUp",function(){var a=document.querySelector("#counter_control");removeColors(),a.classList.add("timeup")}),window.addEventListener("twoMins",function(){var a=document.querySelector("#counter_control");a.classList.add("twoMins")});